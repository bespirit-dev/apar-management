<!doctype html>
<html lang="id">
<head>
  <link rel="icon" href="favicon.png" type="Logo.png">
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Peta Sebaran APAR</title>

  <style>
    :root {
      --bg-page: #ffffff;
      --card: #ffffff;
      --muted: #6b7280;
      --ui-green: #0b6;
      --ui-dark: #042;
      --max-width: 1900px;
      --max-height: 1080px;
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: "bauhaus 93", sans-serif;
      background: var(--bg-page);
      padding: 18px;
      display: flex;
      justify-content: center;
    }

    .container {
      width: 100%;
      max-width: var(--max-width);
      background: var(--card);
      border-radius: 12px;
      overflow: auto;
      box-shadow: 0 8px 30px rgba(2,6,23,0.6);
    }

    .topbar {
      display: flex;
      gap: 12px;
      align-items: center;
      justify-content: space-between;
      padding: 14px 18px;
      border-bottom: 1px solid rgba(15,23,42,0.06);
    }

    /* FULLSCREEN MODE */
    .fullscreen {
      position: fixed !important;
      top: 0; 
      left: 0;
      width: 100vw !important;
      height: 100vh !important;
      margin: 0 !important;
      padding: 0 !important;
      border-radius: 0 !important;
      background: #000; /* biar rapi */
      z-index: 9999 !important;
      display: flex;
      flex-direction: column;
    }

    .fullscreen .map-viewport {
      position: relative;
      width: 100% !important;
      height: 100% !important;
      padding-bottom: 0 !important;
    }

    .fullscreen svg {
      width: 100% !important;
      height: 100% !important;
      object-fit: contain; /* biar proporsi tidak rusak */
    }



    .title h1 { margin: 0; font-size: 18px; color: #0f1720; }
    .subtitle { font-size: 13px; color: var(--muted); }

    .controls { display: flex; gap: 8px; align-items: center; }
    .btn {
      border: 0;
      padding: 8px 12px;
      border-radius: 8px;
      cursor: pointer;
      font-weight: 600;
      font-size: 13px;
    }
    .btn.primary { 
      background: var(--ui-green); 
      color: var(--ui-dark); 
    }

    .btn.ghost { 
      background: transparent; 
      color: #111827; 
      border: 2px solid rgba(2,6,23,0.06); 
    }

    .main {
      display: flex;
      gap: 16px;
      padding: 16px;
      align-items: flex-start;
      flex-wrap: wrap;
    }

    .map-card {
      flex: 1 1 720px;
      min-width: 520px;
      background: #f8fafc;
      border-radius: 10px;
      
      display: flex;
      flex-direction: column;
    }

    .close-btn {
  position: absolute;
  top: 12px;
  right: 12px;
  z-index: 10000;
  background: rgba(0,0,0,0.7);
  color: white;
  border: none;
  padding: 6px 10px;
  font-size: 18px;
  border-radius: 6px;
  cursor: pointer;
  display: none; /* default: tidak terlihat */
}

.fullscreen .close-btn {
  display: block !important; /* muncul ketika fullscreen */
}


    .map-viewport {
      position: relative;
      width: 100%;
      padding-bottom: 56.25%;
      background: #eef2ff;
      overflow: hidden;
    }

    .map-viewport svg {
      position: absolute;
      inset: 0;
      width: 100%;
      height: 100%;
      display: block;
    }

    /* ðŸ”´ Titik pusat */
    .svg-marker-dot {
      fill: #ff2d2d;
      cursor: pointer;
      r: 4;
      transition: transform 0.3s ease, fill 0.3s ease;
      opacity: 0.9;
    }

  .svg-marker-dotc {
        fill: #0033EE;
        cursor: pointer;
        r: 4;
        transition: transform 0.3s ease, fill 0.3s ease;
        opacity: 0.9;
      }

    .svg-marker-dot:hover {
      transform: scale(1.2);
      fill: #ff0000;
    }

    .svg-marker-dotc:hover {
      transform: scale(1.2);
      fill: #1100BB;
    }

    /* ðŸŒŠ Efek radar multi-gelombang */
    .radar-group circle {
      fill: none;
      stroke: #ff2d2d;
      stroke-width: 1px;
      opacity: 0.7;
      transform-origin: center;
      transform-box: fill-box;
      animation: radarWave 4s ease-out infinite;
    }

     .radars-groupc circle {
      fill: none;
      stroke: #0033EE;
      stroke-width: 1px;
      opacity: 0.7;
      transform-origin: center;
      transform-box: fill-box;
      animation: radarsWave 4s ease-out infinite;
    }


    .radar-group circle:nth-child(1){ animation-delay: 0s; }
    .radar-group circle:nth-child(2){ animation-delay: 1.3s; }
    .radar-group circle:nth-child(3){ animation-delay: 2.6s; }

    .radars-groupc circle:nth-child(1){ animation-delay: 0s; }
    .radars-groupc circle:nth-child(2){ animation-delay: 1.3s; }
    .radars-groupc circle:nth-child(3){ animation-delay: 2.6s; }

    @keyframes radarWave {
      0%   { transform: scale(0.3); opacity: 0.8; }
      70%  { transform: scale(1.5); opacity: 0.2; }
      100% { transform: scale(2.5); opacity: 0; }
    }

     @keyframes radarsWave {
      0%   { transform: scale(0.3); opacity: 0.8; }
      70%  { transform: scale(1.5); opacity: 0.2; }
      100% { transform: scale(2.5); opacity: 0; }
    }

    .tooltip {
      position: fixed;
      pointer-events: none;
      background: rgba(0,0,0,0.86);
      color: #fff;
      padding: 8px;
      border-radius: 8px;
      text-align: center;
      display: none;
      z-index: 9999;
    }

    .tooltip img { 
      max-width: 100px; 
      margin-top: 6px; 
      border-radius: 6px; 
    }

    .side {
      width: 320px;
      background: #fff;
      border-radius: 10px;
      padding: 12px;
      box-shadow: 0 6px 20px rgba(2,6,23,0.04);
    }
  </style>
</head>
<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>

<body>
  <div class="container">
    <div class="topbar">
     
      <div class="controls">
        <button class="btn primary" id="exportBtn">Export</button>
        <button class="btn ghost" id="expandBtn">â¤¢</button>

      </div>
    </div>

    <div class="main">
      <div class="map-card">
        <button id="closeFullscreen" class="close-btn">âœ•</button>

        <div class="map-viewport" id="mapViewport">
          <svg viewBox="0 0 800 450" xmlns="http://www.w3.org/2000/svg"
               style="width:100%; height:auto; border-radius:16px; background:#eef1ff;">
            
            <!-- ðŸ—ï¸ Gambar Denah -->
            <image href="Layout.jpg" x="0" y="0" width="800" height="450" />

            <!-- ðŸ”´ Marker -->
            <g class="marker-group" transform="translate(180,210)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 001" data-type="Powder" data-img="apar1.jpeg" data-location ="Pos 1" />
            </g>
            <g class="marker-group" transform="translate(237,272.5)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 002" data-type="Powder" data-img="apar2.jpeg" data-location ="Dapur Mess" />
            </g>
            <g class="marker-group" transform="translate(263,266.5)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 003" data-type="Powder" data-img="apar3.jpeg" data-location ="Kantin 1" />
            </g>
             <g class="marker-group" transform="translate(265,278)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 004" data-type="Powder" data-img="apar4.jpeg" data-location ="Kantin 2" />
            </g>
            <g class="marker-group" transform="translate(288,245)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 005" data-type="Powder" data-img="apar5.jpeg" data-location ="Pos 2" />
            </g>
            <g class="marker-group" transform="translate(257,228)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 006" data-type="Powder" data-img="apar6.jpeg" data-location ="Kantor Utama" />
            </g>
            <g class="marker-group" transform="translate(250,220)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 007" data-type="Powder" data-img="apar7.jpeg" data-location ="Server Out" />
            </g>
            <g class="marker-group" transform="translate(250,228)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 008" data-type="Powder" data-img="apar8.jpeg" data-location ="Genset Server" />
            </g>
            <g class="marker-group" transform="translate(222,222)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 009" data-type="Powder" data-img="apar9.jpeg" data-location ="Workshop Lama" />
            </g>
            <g class="marker-group" transform="translate(222,230)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 010" data-type="Powder" data-img="apar10.jpeg" data-location ="Cubicle" />
            </g>
            <g class="marker-group" transform="translate(203,200)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 011" data-type="Powder" data-img="apar11.jpeg" data-location ="Area B3" />
            </g>
            <g class="marker-group" transform="translate(205,178)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 012" data-type="Powder" data-img="apar12.jpeg" data-location ="Vacuum Amoniak" />
            </g>
            <g class="marker-group" transform="translate(202,167)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 013" data-type="Powder" data-img="apar13.jpeg" data-location="KA Supporting"/>
            </g>
             <g class="marker-group" transform="translate(217,178)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 014" data-type="Powder" data-img="apar14.jpeg" data-location ="Coating L3" />
            </g>
            <g class="marker-group" transform="translate(240,178)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 015" data-type="CO2" data-img="apar15.jpeg" data-location ="Coating L3" />
            </g>
            <g class="marker-group" transform="translate(270,178)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 016" data-type="Powder" data-img="apar16.jpeg" data-location ="Coating L3" />
            </g>
             <g class="marker-group" transform="translate(288,178)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 017" data-type="Powder" data-img="apar17.jpeg" data-location ="Dojo" />
            </g>
            <g class="marker-group" transform="translate(290,188)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 018" data-type="Powder" data-img="apar18.jpeg" data-location ="RnD" />
            </g>
            <g class="marker-group" transform="translate(260,185)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 019" data-type="Powder" data-img="apar19.jpeg" data-location ="Pallet" />
            </g>
            <g class="marker-group" transform="translate(280,198)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 020" data-type="Powder" data-img="apar20.jpeg" data-location ="GBJ" />
            </g>
            <g class="marker-group" transform="translate(230,198)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 021" data-type="Powder" data-img="apar21.jpeg" data-location ="GBJ" />
            </g>
            <g class="marker-group" transform="translate(256,170)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 022" data-type="Powder" data-img="apar22.jpeg" data-location ="Purette" />
            </g>
            <g class="marker-group" transform="translate(248,170)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 023" data-type="Powder" data-img="apar23.jpeg" data-location ="Purette" />
            </g>
            <g class="marker-group" transform="translate(240,170)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 024" data-type="Powder" data-img="apar24.jpeg" data-location ="Purette" />
            </g>
            <g class="marker-group" transform="translate(232,170)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 025" data-type="Powder" data-img="apar25.jpeg" data-location ="Purette" />
            </g>
            <g class="marker-group" transform="translate(224,170)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 026" data-type="Powder" data-img="apar26.jpeg" data-location ="Purette" />
            </g>
            <g class="marker-group" transform="translate(207,151)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 027" data-type="Powder" data-img="apar27.jpeg" data-location ="Gudang Klump" />
            </g>
            <g class="marker-group" transform="translate(232,162)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 028" data-type="Powder" data-img="apar28.jpeg" data-location ="PQ Dempul" />
            </g>
            <g class="marker-group" transform="translate(248,162)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 029" data-type="Powder" data-img="apar29.jpeg" data-location ="PQ Sortir" />
            </g>
            <g class="marker-group" transform="translate(238,150)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 030" data-type="Powder" data-img="apar30.jpeg" data-location ="Torwegee" />
            </g>
            <g class="marker-group" transform="translate(235,152)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 031" data-type="Powder" data-img="apar31.jpeg" data-location ="PQ Profiling" />
            </g>
            <g class="marker-group" transform="translate(228,152)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 032" data-type="Powder" data-img="apar32.jpeg" data-location ="PQ Homag 1" />
            </g>
            <g class="marker-group" transform="translate(230,155)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 033" data-type="Powder" data-img="apar33.jpeg" data-location ="PQ Homag 2" />
            </g>
            <g class="marker-group" transform="translate(240,160)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 034" data-type="Powder" data-img="apar34.jpeg" data-location ="PowerMATT" />
            </g>
            <g class="marker-group" transform="translate(210,130)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 035" data-type="Powder" data-img="apar35.jpeg" data-location ="HP 3" />
            </g>
            <g class="marker-group" transform="translate(210,145)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 036" data-type="Powder" data-img="apar36.jpeg" data-location ="Bejana 1" />
            </g>
             <g class="marker-group" transform="translate(225,135)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 037" data-type="Powder" data-img="apar37.jpeg" data-location ="HP 2-3" />
            </g>
            <g class="marker-group" transform="translate(255,135)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 038" data-type="Powder" data-img="apar38.jpeg" data-location ="Sander Butferring"/>
            </g>
            <g class="marker-group" transform="translate(255,150)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 039" data-type="Powder" data-img="apar39.jpeg" data-location ="Bejana 2"/>
            </g>
             <g class="marker-group" transform="translate(265,150)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 040" data-type="Powder" data-img="apar40.jpeg" data-location ="Sander PQ"/>
            </g>
             <g class="marker-group" transform="translate(265,135)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 041" data-type="Powder" data-img="apar41.jpeg" data-location ="White Wash"/>
            </g>
             <g class="marker-group" transform="translate(255,117)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 042" data-type="Powder" data-img="apar42.jpeg" data-location ="KUPER"/>
            </g>
            <g class="marker-group" transform="translate(277,120)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 043" data-type="Powder" data-img="apar43.jpeg" data-location ="DP"/>
            </g>
            <g class="marker-group" transform="translate(306.5,177)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 044" data-type="Powder" data-img="apar44.jpeg" data-location ="CR"/>
            </g>
            <g class="marker-group" transform="translate(306.5,157)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 045" data-type="Powder" data-img="apar45.jpeg" data-location ="CR"/>
            </g>
            <g class="marker-group" transform="translate(306.5,127)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 046" data-type="Powder" data-img="apar46.jpeg" data-location ="CR"/>
            </g>
             <g class="marker-group" transform="translate(323,137)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 047" data-type="Powder" data-img="apar47.jpeg" data-location ="KD HDS"/>
            </g>
            <g class="marker-group" transform="translate(323,187)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 048" data-type="Powder" data-img="apar48.jpeg" data-location ="KD HDS"/>
            </g>
            <g class="marker-group" transform="translate(308,205)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 049" data-type="Powder" data-img="apar49.jpeg" data-location ="Warehouse"/>
            </g>
            <g class="marker-group" transform="translate(305,197)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 050" data-type="Powder" data-img="apar50.jpeg" data-location ="Warehouse"/>
            </g>
            <g class="marker-group" transform="translate(299,185)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 051" data-type="Powder" data-img="apar51.jpeg" data-location ="Warehouse"/>
            </g>
            <g class="marker-group" transform="translate(300,205)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 052" data-type="Powder" data-img="apar52.jpeg" data-location ="Warehouse"/>
            </g>
            <g class="marker-group" transform="translate(298,223)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 053" data-type="Powder" data-img="apar53.jpeg" data-location ="Compressor"/>
            </g>
            <g class="marker-group" transform="translate(298,230)">
              <circle class="svg-marker-dotc" r="4" data-name="APAR 054" data-type="CO2" data-img="apar54.jpeg" data-location ="Power House 1"/>
            </g>
            <g class="marker-group" transform="translate(290,230)">
              <circle class="svg-marker-dotc" r="4" data-name="APAR 055" data-type="CO2" data-img="apar55.jpeg" data-location ="Power House 1"/>
            </g>
            <g class="marker-group" transform="translate(298,217)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 056" data-type="Powder" data-img="apar56.jpeg" data-location ="Compressor"/>
            </g>
             <g class="marker-group" transform="translate(315,220)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 057" data-type="Powder" data-img="apar57.jpeg" data-location ="HTO Depan"/>
            </g>
             <g class="marker-group" transform="translate(335,127)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 058" data-type="Powder" data-img="apar58.jpeg" data-location ="Engineering"/>
            </g>
             <g class="marker-group" transform="translate(333,120)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 059" data-type="Powder" data-img="apar59.jpeg" data-location ="Maintenance"/>
            </g>
            <g class="marker-group" transform="translate(352,135)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 060" data-type="Powder" data-img="apar60.jpeg" data-location ="Prep L2"/>
            </g>
            <g class="marker-group" transform="translate(362,135)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 061" data-type="Powder" data-img="apar61.jpeg" data-location ="Tagliabue"/>
            </g>
            <g class="marker-group" transform="translate(380,120)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 062" data-type="Powder" data-img="apar62.jpeg" data-location ="Chelasci"/>
            </g>
            <g class="marker-group" transform="translate(364,120)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 063" data-type="Powder" data-img="apar63.jpeg" data-location ="Moulding Prep"/>
            </g>
            <g class="marker-group" transform="translate(395,125)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 064" data-type="Powder" data-img="apar64.jpeg" data-location ="Hydrant 1"/>
            </g>
            <g class="marker-group" transform="translate(375,135)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 065" data-type="Powder" data-img="apar65.jpeg" data-location ="Split lamella"/>
            </g>
            <g class="marker-group" transform="translate(385,145)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 066" data-type="Powder" data-img="apar66.jpeg" data-location ="DSG"/>
            </g>
            <g class="marker-group" transform="translate(370,160)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 067" data-type="Powder" data-img="apar67.jpeg" data-location ="LeaderMAC"/>
            </g>
            <g class="marker-group" transform="translate(362,143)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 068" data-type="Powder" data-img="apar68.jpeg" data-location ="Finger Joint"/>
            </g>
            <g class="marker-group" transform="translate(372,151)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 069" data-type="Powder" data-img="apar69.jpeg" data-location ="HP Comp"/>
            </g>
            <g class="marker-group" transform="translate(352,151)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 070" data-type="Powder" data-img="apar70.jpeg" data-location ="Sander Prep"/>
            </g>
            <g class="marker-group" transform="translate(356,166)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 071" data-type="Powder" data-img="apar71.jpeg" data-location ="Prep L2"/>
            </g>
            <g class="marker-group" transform="translate(373,163)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 072" data-type="Powder" data-img="apar72.jpeg" data-location ="Glue 9 Ft"/>
            </g>
            <g class="marker-group" transform="translate(375,175)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 073" data-type="Powder" data-img="apar73.jpeg" data-location ="HTO Prep"/>
            </g>
            <g class="marker-group" transform="translate(385,165)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 074" data-type="Powder" data-img="apar74.jpeg" data-location ="PPAD 12 Greecon"/>
            </g>
             <g class="marker-group" transform="translate(398,135)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 075" data-type="Powder" data-img="apar75.jpeg" data-location ="Maspell"/>
            </g>
            <g class="marker-group" transform="translate(461,135)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 076" data-type="Powder" data-img="apar76.jpeg" data-location ="Ex Substrate" />
            </g>
            <g class="marker-group" transform="translate(496,131)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 077" data-type="Powder" data-img="apar77.jpeg" data-location ="Hydrant 2" />
            </g>
             <g class="marker-group" transform="translate(500,151)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 078" data-type="Powder" data-img="apar78.jpeg" data-location="Loading 3" />
            </g>
            <g class="marker-group" transform="translate(515,151)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 079" data-type="Powder" data-img="apar79.jpeg" data-location="GBB A" />
            </g>
            <g class="marker-group" transform="translate(515,162.5)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 080" data-type="Powder" data-img="apar80.jpeg" data-location="GBB B" />
            </g>
            <g class="marker-group" transform="translate(555,140)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 081" data-type="Powder" data-img="apar81.jpeg" data-location="GBB A" />
            </g>
            <g class="marker-group" transform="translate(575,160)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 082" data-type="Powder" data-img="apar82.jpeg" data-location="GBB B" />
            </g>
            <g class="marker-group" transform="translate(575,177)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 083" data-type="Powder" data-img="apar83.jpeg" data-location="GBB C" />
            </g>
             <g class="marker-group" transform="translate(570,182)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 084" data-type="Powder" data-img="apar84.jpeg" data-location="Sport Center" />
            </g>
            <g class="marker-group" transform="translate(530,205)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 085" data-type="Powder" data-img="apar85.jpeg" data-location="Tirtoredjo" />
            </g>
            <g class="marker-group" transform="translate(500,200)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 086" data-type="Powder" data-img="apar86.jpeg" data-location="Power House 2" />
            </g>
            <g class="marker-group" transform="translate(475,190)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 087" data-type="Powder" data-img="apar87.jpeg" data-location="Eks Sawmill" />
            </g>
            <g class="marker-group" transform="translate(465,181)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 088" data-type="Powder" data-img="apar88.jpeg" data-location="Eks Sawmill" />
            </g>
            <g class="marker-group" transform="translate(450,190)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 089" data-type="Powder" data-img="apar89.jpeg" data-location="Eks Sawmill" />
            </g>  
            <g class="marker-group" transform="translate(450,200)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 090" data-type="Powder" data-img="apar90.jpeg" data-location="Drum Dryer" />
            </g>
            <g class="marker-group" transform="translate(440,200)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 091" data-type="Powder" data-img="apar91.jpeg" data-location="Drum Dryer" />
            </g>
            <g class="marker-group" transform="translate(422,215)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 092" data-type="Powder" data-img="apar92.jpeg" data-location="Pellet" />
            </g>
            <g class="marker-group" transform="translate(411,215)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 093" data-type="Powder" data-img="apar93.jpeg" data-location="Pellet" />
            </g>
            <g class="marker-group" transform="translate(400,215)">
              <circle class="svg-marker-dot" r="4" data-name="APAR 094" data-type="Powder" data-img="apar94.jpeg" data-location="Pellet" />
            </g>
            
            </svg>
        </div>
      </div>

  <div id="tooltip" class="tooltip"></div>

  <script>
    const tooltip = document.getElementById('tooltip');
    const sideInfo = document.getElementById('sideInfo');
    const markers = document.querySelectorAll('.svg-marker-dot');
    const markersc = document.querySelectorAll('.svg-marker-dotc');

    markers.forEach(marker => {
      marker.addEventListener('mouseenter', e => {
        tooltip.innerHTML = `<strong>${marker.dataset.name}</strong><br>${marker.dataset.type}<br><img src="${marker.dataset.img}"<br><br>${marker.dataset.location}`;
        tooltip.style.display = 'block';
      });
      marker.addEventListener('mousemove', e => {
        tooltip.style.left = e.clientX + 'px';
        tooltip.style.top = (e.clientY - 10) + 'px';
      });
      marker.addEventListener('mouseleave', () => tooltip.style.display = 'none');
    });

     markersc.forEach(marker => {
      marker.addEventListener('mouseenter', e => {
        tooltip.innerHTML = `<strong>${marker.dataset.name}</strong><br>${marker.dataset.type}<br><img src="${marker.dataset.img}"<br><br>${marker.dataset.location}`;
        tooltip.style.display = 'block';
      });
      marker.addEventListener('mousemove', e => {
        tooltip.style.left = e.clientX + 'px';
        tooltip.style.top = (e.clientY - 10) + 'px';
      });
      marker.addEventListener('mouseleave', () => tooltip.style.display = 'none');
    });

    // ðŸŒŠ Tambahkan Efek Radar Otomatis untuk Semua Marker
    document.querySelectorAll('.svg-marker-dot').forEach(marker => {
      const parent = marker.parentElement;
      if (!parent.querySelector('.radar-group')) {
        const radarGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
        radarGroup.setAttribute('class', 'radar-group');
        for (let i = 0; i < 3; i++) {
          const c = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
          c.setAttribute('r', '10');
          radarGroup.appendChild(c);
        }
        parent.insertBefore(radarGroup, marker);
      }
    });

    // ðŸŒŠ Tambahkan Efek Radar Otomatis Marker C02
    document.querySelectorAll('.svg-marker-dotc').forEach(marker => {
      const parent = marker.parentElement;
      if (!parent.querySelector('.radars-groupc')) {
        const radarsGroupc = document.createElementNS('http://www.w3.org/2000/svg', 'g');
        radarsGroupc.setAttribute('class', 'radars-groupc');
        for (let i = 0; i < 3; i++) {
          const c = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
          c.setAttribute('r', '10');
          radarsGroupc.appendChild(c);
        }
        parent.insertBefore(radarsGroupc, marker);
      }
    });

    // ðŸ§¾ Export & Download
    document.getElementById('exportBtn').addEventListener('click', () => {
      const data = Array.from(markers).map(m => {
        const t = m.parentElement.getAttribute('transform');
        let coords = [0,0];
        if (t) {
          const match = t.match(/translate\(([\d.]+),([\d.]+)\)/);
          if (match) coords = [parseFloat(match[1]), parseFloat(match[2])];
        }
        return { name: m.dataset.name, type: m.dataset.type, x: coords[0], y: coords[1], img: m.dataset.img };
      });
      const json = JSON.stringify(data, null, 2);
      let exportArea = document.getElementById('exportArea');
      if (!exportArea) {
        const ta = document.createElement('textarea');
        ta.id = 'exportArea';
        ta.style.width = '100%';
        ta.style.height = '120px';
        ta.value = json;
        sideInfo.appendChild(ta);
      } else exportArea.value = json;
    });

      // ðŸ” Fullscreen Toggle

    const expandBtn = document.getElementById("expandBtn");
      const closeBtn = document.getElementById("closeFullscreen");
      const mapCard = document.querySelector(".map-card");

     expandBtn.addEventListener("click", () => {
      mapCard.classList.add("fullscreen");
    });

    closeBtn.addEventListener("click", () => {
      mapCard.classList.remove("fullscreen");
    });

    const exportPngBtn = document.getElementById("exportPngBtn");
const mapViewport = document.getElementById("mapViewport");

exportPngBtn.addEventListener("click", () => {
  html2canvas(mapViewport, {
    backgroundColor: null, // jika ingin background transparan
    scale: 2               // resolusi lebih tinggi
  }).then(canvas => {
    const link = document.createElement("a");
    link.download = "denah_apar.png";
    link.href = canvas.toDataURL("image/png");
    link.click();
  });
});





  </script>
</body>
</html>


